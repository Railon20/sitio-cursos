(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{4001:function(e,r,t){Promise.resolve().then(t.bind(t,1065))},7977:function(e,r,t){"use strict";t.d(r,{Z:function(){return c}});var a=t(4090);/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,t)=>t?t.toUpperCase():r.toLowerCase()),i=e=>{let r=l(e);return r.charAt(0).toUpperCase()+r.slice(1)},n=function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return r.filter((e,r,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===r).join(" ").trim()};/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,a.forwardRef)((e,r)=>{let{color:t="currentColor",size:s=24,strokeWidth:l=2,absoluteStrokeWidth:i,className:d="",children:c,iconNode:u,...m}=e;return(0,a.createElement)("svg",{ref:r,...o,width:s,height:s,stroke:t,strokeWidth:i?24*Number(l)/Number(s):l,className:n("lucide",d),...m},[...u.map(e=>{let[r,t]=e;return(0,a.createElement)(r,t)}),...Array.isArray(c)?c:[c]])}),c=(e,r)=>{let t=(0,a.forwardRef)((t,l)=>{let{className:o,...c}=t;return(0,a.createElement)(d,{ref:l,iconNode:r,className:n("lucide-".concat(s(i(e))),"lucide-".concat(e),o),...c})});return t.displayName=i(e),t}},4562:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(7977).Z)("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]])},7907:function(e,r,t){"use strict";var a=t(5313);t.o(a,"useParams")&&t.d(r,{useParams:function(){return a.useParams}}),t.o(a,"usePathname")&&t.d(r,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(r,{useSearchParams:function(){return a.useSearchParams}})},1065:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return m}});var a=t(3827),s=t(4090),l=t(7907),i=t(8714),n=t(575),o=t(7977);let d=(0,o.Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),c=(0,o.Z)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var u=t(4562);function m(){let e=(0,l.useRouter)(),r=(0,i.createPagesBrowserClient)(),[t,o]=(0,s.useState)([]),[m,h]=(0,s.useState)({}),[p,x]=(0,s.useState)(null),[f,g]=(0,s.useState)(!0),[v,b]=(0,s.useState)({title:"",description:"",category:"",difficulty:"",price:""}),[y,j]=(0,s.useState)(null),[N,w]=(0,s.useState)({});(0,s.useEffect)(()=>{(async()=>{var t;let{data:{session:a}}=await r.auth.getSession();if(!a||(null===(t=a.user.user_metadata)||void 0===t?void 0:t.role)!=="admin"){e.push("/acceso-denegado");return}await C()})()},[]);let C=async()=>{let{data:e,error:t}=await r.from("courses").select("*").order("created_at",{ascending:!1});t||o(e||[]),g(!1)},k=async e=>{let{data:t}=await r.from("modules").select("*").eq("course_id",e).order("order_number");h(r=>({...r,[e]:t||[]}))},_=async()=>{if(!y)return null;let e="".concat(Date.now(),"_").concat(y.name),{error:t}=await r.storage.from("course-images").upload(e,y,{cacheControl:"3600",upsert:!1});if(t)return console.error("Error subiendo imagen:",t.message),null;let{data:a}=r.storage.from("course-images").getPublicUrl(e);return(null==a?void 0:a.publicUrl)||null},P=async()=>{let{title:e,description:t,category:a,difficulty:s,price:l}=v;if(!e||!t||!a||!s||!l||!y){alert("Todos los campos son obligatorios, incluida la imagen.");return}let i=await _();if(!i){alert("Error al subir la imagen de portada");return}let{error:n}=await r.from("courses").insert([{title:e,description:t,image:i,category:a,difficulty:s,price:Number(l)}]);n?alert("Error al crear el curso: "+n.message):(b({title:"",description:"",category:"",difficulty:"",price:""}),j(null),await C())},E=async e=>{if(!confirm("\xbfSeguro que quer\xe9s eliminar este curso?"))return;let{error:t}=await r.from("courses").delete().eq("id",e);t||await C()},S=async e=>{p===e?x(null):(x(e),await k(e))},z=async e=>{let{title:t,content:a,order_number:s}=N[e]||{};if(!t||!a||!s){alert("Todos los campos de m\xf3dulo son obligatorios.");return}let{error:l}=await r.from("modules").insert([{course_id:e,title:t,content:a,order_number:Number(s)}]);l?alert("Error al crear m\xf3dulo: "+l.message):(w(r=>({...r,[e]:{}})),await k(e))},M=async(e,t)=>{if(!confirm("\xbfEliminar este m\xf3dulo?"))return;let{error:a}=await r.from("modules").delete().eq("id",e);a||await k(t)};return(0,a.jsx)("main",{className:"min-h-screen bg-gray-50 px-6 py-10",children:(0,a.jsxs)("div",{className:"max-w-5xl mx-auto",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-8 text-sky-700",children:"Panel de administraci\xf3n"}),(0,a.jsxs)("section",{className:"bg-white p-6 rounded-xl shadow mb-12",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Crear nuevo curso"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,a.jsx)("input",{placeholder:"T\xedtulo",value:v.title,onChange:e=>b({...v,title:e.target.value}),className:"border p-2 rounded"}),(0,a.jsx)("input",{placeholder:"Categor\xeda",value:v.category,onChange:e=>b({...v,category:e.target.value}),className:"border p-2 rounded"}),(0,a.jsx)("input",{placeholder:"Dificultad",value:v.difficulty,onChange:e=>b({...v,difficulty:e.target.value}),className:"border p-2 rounded"}),(0,a.jsx)("input",{placeholder:"Precio",type:"number",value:v.price,onChange:e=>b({...v,price:e.target.value}),className:"border p-2 rounded"}),(0,a.jsx)("input",{placeholder:"Descripci\xf3n",value:v.description,onChange:e=>b({...v,description:e.target.value}),className:"border p-2 rounded md:col-span-2"}),(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{e.target.files&&e.target.files[0]&&j(e.target.files[0])},className:"border p-2 rounded md:col-span-2"})]}),(0,a.jsxs)(n.z,{onClick:P,className:"flex items-center gap-2",children:[(0,a.jsx)(d,{className:"w-4 h-4"})," Crear curso"]})]}),(0,a.jsxs)("section",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Cursos existentes"}),f?(0,a.jsx)("p",{children:"Cargando cursos..."}):(0,a.jsx)("div",{className:"space-y-8",children:t.map(e=>{var r,t,s,l,i;return(0,a.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-bold",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:e.description}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Categor\xeda: ",e.category," | Dificultad: ",e.difficulty," | Precio: $",e.price]})]}),(0,a.jsx)(n.z,{onClick:()=>E(e.id),variant:"outline",className:"p-1 text-sm text-red-600 border-red-600 hover:bg-red-50",children:(0,a.jsx)(c,{className:"w-4 h-4"})})]}),(0,a.jsxs)(n.z,{onClick:()=>S(e.id),variant:"outline",className:"mb-4",children:[(0,a.jsx)(u.Z,{className:"w-4 h-4 mr-1"}),p===e.id?"Ocultar m\xf3dulos":"Ver m\xf3dulos"]}),p===e.id&&(0,a.jsxs)("div",{className:"mt-4 space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-semibold",children:"Crear m\xf3dulo"}),(0,a.jsx)("input",{placeholder:"T\xedtulo del m\xf3dulo",className:"border p-2 w-full rounded",value:(null===(r=N[e.id])||void 0===r?void 0:r.title)||"",onChange:r=>w(t=>({...t,[e.id]:{...t[e.id],title:r.target.value}}))}),(0,a.jsx)("textarea",{placeholder:"Contenido (us\xe1 ![texto](url) para im\xe1genes)",className:"border p-2 w-full rounded",rows:6,value:(null===(t=N[e.id])||void 0===t?void 0:t.content)||"",onChange:r=>w(t=>({...t,[e.id]:{...t[e.id],content:r.target.value}}))}),(0,a.jsx)("input",{placeholder:"Orden del m\xf3dulo",type:"number",className:"border p-2 w-full rounded",value:(null===(s=N[e.id])||void 0===s?void 0:s.order_number)||"",onChange:r=>w(t=>({...t,[e.id]:{...t[e.id],order_number:r.target.value}}))}),(0,a.jsx)(n.z,{onClick:()=>z(e.id),children:"Guardar m\xf3dulo"})]}),(0,a.jsxs)("div",{className:"pt-4 border-t",children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:"M\xf3dulos existentes"}),(null===(l=m[e.id])||void 0===l?void 0:l.length)===0?(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Este curso no tiene m\xf3dulos."}):(0,a.jsx)("ul",{className:"space-y-2",children:null===(i=m[e.id])||void 0===i?void 0:i.map(r=>(0,a.jsxs)("li",{className:"flex justify-between items-start border p-2 rounded",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-medium",children:[r.order_number,". ",r.title]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 whitespace-pre-line",children:r.content})]}),(0,a.jsx)(n.z,{onClick:()=>M(r.id,e.id),variant:"outline",className:"p-1 text-sm text-red-600 border-red-600 hover:bg-red-50",children:(0,a.jsx)(c,{className:"w-4 h-4"})})]},r.id))})]})]})]},e.id)})})]})]})})}},575:function(e,r,t){"use strict";t.d(r,{z:function(){return s}});var a=t(3827);t(4090);let s=e=>{let{children:r,variant:t="default",className:s,...l}=e;return(0,a.jsx)("button",{className:"".concat("px-4 py-2 rounded font-medium transition"," ").concat({default:"bg-indigo-600 text-white hover:bg-indigo-700",outline:"border border-gray-300 text-gray-800 hover:bg-gray-100"}[t]," ").concat(s),...l,children:r})}}},function(e){e.O(0,[51,714,971,69,744],function(){return e(e.s=4001)}),_N_E=e.O()}]);