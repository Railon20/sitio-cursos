(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{4001:function(e,r,a){Promise.resolve().then(a.bind(a,1065))},7977:function(e,r,a){"use strict";a.d(r,{Z:function(){return c}});var t=a(4090);/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,a)=>a?a.toUpperCase():r.toLowerCase()),i=e=>{let r=l(e);return r.charAt(0).toUpperCase()+r.slice(1)},o=function(){for(var e=arguments.length,r=Array(e),a=0;a<e;a++)r[a]=arguments[a];return r.filter((e,r,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===r).join(" ").trim()};/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,t.forwardRef)((e,r)=>{let{color:a="currentColor",size:s=24,strokeWidth:l=2,absoluteStrokeWidth:i,className:d="",children:c,iconNode:u,...m}=e;return(0,t.createElement)("svg",{ref:r,...n,width:s,height:s,stroke:a,strokeWidth:i?24*Number(l)/Number(s):l,className:o("lucide",d),...m},[...u.map(e=>{let[r,a]=e;return(0,t.createElement)(r,a)}),...Array.isArray(c)?c:[c]])}),c=(e,r)=>{let a=(0,t.forwardRef)((a,l)=>{let{className:n,...c}=a;return(0,t.createElement)(d,{ref:l,iconNode:r,className:o("lucide-".concat(s(i(e))),"lucide-".concat(e),n),...c})});return a.displayName=i(e),a}},4562:function(e,r,a){"use strict";a.d(r,{Z:function(){return t}});let t=(0,a(7977).Z)("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]])},1065:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return h}});var t=a(3827),s=a(4090),l=a(7907),i=a(8714),o=a(575),n=a(7977);let d=(0,n.Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),c=(0,n.Z)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var u=a(4562),m=a(8009);function h(){let e=(0,l.useRouter)(),r=(0,i.createPagesBrowserClient)(),[a,n]=(0,s.useState)([]),[h,p]=(0,s.useState)({}),[x,g]=(0,s.useState)(null),[f,v]=(0,s.useState)(!0),[b,y]=(0,s.useState)({title:"",description:"",category:"",difficulty:"",price:""}),[j,N]=(0,s.useState)(null),[w,C]=(0,s.useState)({});(0,s.useEffect)(()=>{(async()=>{var a;let{data:{session:t}}=await r.auth.getSession();if(!t||(null===(a=t.user.user_metadata)||void 0===a?void 0:a.role)!=="admin"){e.push("/acceso-denegado");return}await k()})()},[e,r]);let k=async()=>{let{data:e,error:a}=await r.from("courses").select("*").order("created_at",{ascending:!1});a?m.ZP.error("Error cargando cursos: "+a.message):n(e||[]),v(!1)},Z=async e=>{let{data:a,error:t}=await r.from("modules").select("*").eq("course_id",e).order("order_number");t?m.ZP.error("Error cargando m\xf3dulos: "+t.message):p(r=>({...r,[e]:a||[]}))},P=async()=>{if(!j)return m.ZP.error("Seleccion\xe1 una imagen de portada."),null;let e="".concat(Date.now(),"_").concat(j.name),a=m.ZP.loading("Subiendo imagen de portada..."),{error:t}=await r.storage.from("course-images").upload(e,j,{cacheControl:"3600",upsert:!1});if(t)return m.ZP.dismiss(a),m.ZP.error("Error subiendo imagen: "+t.message),null;let{data:s}=r.storage.from("course-images").getPublicUrl(e);return(m.ZP.dismiss(a),null==s?void 0:s.publicUrl)?s.publicUrl:(m.ZP.error("No se pudo obtener la URL p\xfablica de la imagen."),null)},_=async()=>{let{title:e,description:a,category:t,difficulty:s,price:l}=b;if(!e||!a||!t||!s||!l||!j){m.ZP.error("Completa todos los campos incluyendo la imagen de portada.");return}let i=await P();if(!i)return;let{error:o}=await r.from("courses").insert([{title:e,description:a,image:i,category:t,difficulty:s,price:Number(l)}]);o?m.ZP.error("Error al crear el curso: "+o.message):(m.ZP.success("Curso creado con \xe9xito"),y({title:"",description:"",category:"",difficulty:"",price:""}),N(null),await k())},E=async e=>{if(!confirm("\xbfSeguro que quer\xe9s eliminar este curso?"))return;let{error:a}=await r.from("courses").delete().eq("id",e);a?m.ZP.error("Error al eliminar curso: "+a.message):(m.ZP.success("Curso eliminado"),await k())},S=async e=>{x===e?g(null):(g(e),await Z(e))},M=async e=>{let{title:a,content:t,order_number:s}=w[e]||{};if(!a||!t||!s){m.ZP.error("Todos los campos de m\xf3dulo son obligatorios.");return}let{error:l}=await r.from("modules").insert([{course_id:e,title:a,content:t,order_number:Number(s)}]);l?m.ZP.error("Error al crear m\xf3dulo: "+l.message):(m.ZP.success("M\xf3dulo creado"),C(r=>({...r,[e]:{}})),await Z(e))},z=async(e,a)=>{if(!confirm("\xbfEliminar este m\xf3dulo?"))return;let{error:t}=await r.from("modules").delete().eq("id",e);t?m.ZP.error("Error al eliminar m\xf3dulo: "+t.message):(m.ZP.success("M\xf3dulo eliminado"),await Z(a))};return(0,t.jsx)("main",{className:"min-h-screen bg-gray-50 px-6 py-10",children:(0,t.jsxs)("div",{className:"max-w-5xl mx-auto",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold mb-8 text-sky-700",children:"Panel de administraci\xf3n"}),(0,t.jsxs)("section",{className:"bg-white p-6 rounded-xl shadow mb-12",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Crear nuevo curso"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,t.jsx)("input",{placeholder:"T\xedtulo",value:b.title,onChange:e=>y({...b,title:e.target.value}),className:"border p-2 rounded"}),(0,t.jsx)("input",{placeholder:"Categor\xeda",value:b.category,onChange:e=>y({...b,category:e.target.value}),className:"border p-2 rounded"}),(0,t.jsx)("input",{placeholder:"Dificultad",value:b.difficulty,onChange:e=>y({...b,difficulty:e.target.value}),className:"border p-2 rounded"}),(0,t.jsx)("input",{placeholder:"Precio",type:"number",value:b.price,onChange:e=>y({...b,price:e.target.value}),className:"border p-2 rounded"}),(0,t.jsx)("textarea",{placeholder:"Descripci\xf3n",value:b.description,onChange:e=>y({...b,description:e.target.value}),className:"border p-2 rounded md:col-span-2"}),(0,t.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{e.target.files&&e.target.files[0]&&N(e.target.files[0])},className:"border p-2 rounded md:col-span-2"})]}),(0,t.jsxs)(o.z,{onClick:_,className:"flex items-center gap-2",children:[(0,t.jsx)(d,{className:"w-4 h-4"})," Crear curso"]})]}),(0,t.jsxs)("section",{children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Cursos existentes"}),f?(0,t.jsx)("p",{children:"Cargando cursos..."}):(0,t.jsx)("div",{className:"space-y-8",children:a.map(e=>{var r,a,s,l,i;return(0,t.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-xl font-bold",children:e.title}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:e.description}),(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:["Categor\xeda: ",e.category," | Dificultad: ",e.difficulty," | Precio: $",e.price]})]}),(0,t.jsx)(o.z,{onClick:()=>E(e.id),variant:"outline",className:"p-1 text-sm text-red-600 border-red-600 hover:bg-red-50",children:(0,t.jsx)(c,{className:"w-4 h-4"})})]}),(0,t.jsxs)(o.z,{onClick:()=>S(e.id),variant:"outline",className:"mb-4",children:[(0,t.jsx)(u.Z,{className:"w-4 h-4 mr-1"}),x===e.id?"Ocultar m\xf3dulos":"Ver m\xf3dulos"]}),x===e.id&&(0,t.jsxs)("div",{className:"mt-4 space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("h4",{className:"font-semibold",children:"Crear m\xf3dulo"}),(0,t.jsx)("input",{placeholder:"T\xedtulo del m\xf3dulo",className:"border p-2 w-full rounded",value:(null===(r=w[e.id])||void 0===r?void 0:r.title)||"",onChange:r=>C(a=>({...a,[e.id]:{...a[e.id],title:r.target.value}}))}),(0,t.jsx)("textarea",{placeholder:"Contenido (us\xe1 ![texto](url) para im\xe1genes)",className:"border p-2 w-full rounded",rows:6,value:(null===(a=w[e.id])||void 0===a?void 0:a.content)||"",onChange:r=>C(a=>({...a,[e.id]:{...a[e.id],content:r.target.value}}))}),(0,t.jsx)("input",{placeholder:"Orden del m\xf3dulo",type:"number",className:"border p-2 w-full rounded",value:(null===(s=w[e.id])||void 0===s?void 0:s.order_number)||"",onChange:r=>C(a=>({...a,[e.id]:{...a[e.id],order_number:r.target.value}}))}),(0,t.jsx)(o.z,{onClick:()=>M(e.id),children:"Guardar m\xf3dulo"})]}),(0,t.jsxs)("div",{className:"pt-4 border-t",children:[(0,t.jsx)("h4",{className:"font-semibold mb-2",children:"M\xf3dulos existentes"}),(null===(l=h[e.id])||void 0===l?void 0:l.length)===0?(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Este curso no tiene m\xf3dulos."}):(0,t.jsx)("ul",{className:"space-y-2",children:null===(i=h[e.id])||void 0===i?void 0:i.map(r=>(0,t.jsxs)("li",{className:"flex justify-between items-start border p-2 rounded",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"font-medium",children:[r.order_number,". ",r.title]}),(0,t.jsx)("p",{className:"text-sm text-gray-600 whitespace-pre-line",children:r.content})]}),(0,t.jsx)(o.z,{onClick:()=>z(r.id,e.id),variant:"outline",className:"p-1 text-sm text-red-600 border-red-600 hover:bg-red-50",children:(0,t.jsx)(c,{className:"w-4 h-4"})})]},r.id))})]})]})]},e.id)})})]})]})})}},575:function(e,r,a){"use strict";a.d(r,{z:function(){return s}});var t=a(3827);a(4090);let s=e=>{let{children:r,variant:a="default",className:s,...l}=e;return(0,t.jsx)("button",{className:"".concat("px-4 py-2 rounded font-medium transition"," ").concat({default:"bg-indigo-600 text-white hover:bg-indigo-700",outline:"border border-gray-300 text-gray-800 hover:bg-gray-100"}[a]," ").concat(s),...l,children:r})}}},function(e){e.O(0,[51,714,296,971,69,744],function(){return e(e.s=4001)}),_N_E=e.O()}]);